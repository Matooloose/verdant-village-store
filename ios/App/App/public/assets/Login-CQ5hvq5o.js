import{u as Z,a as G,h as K,j as e,i as Q,p as X,C as Y,c as _,d as ee,q as se,e as te,B as F,L as R}from"./index-cM6hlhfj.js";import{r as a}from"./vendor-Gsz-jK4b.js";import{I as T}from"./input-lvqziEey.js";import{L as b}from"./label-D9QexlfX.js";import{C as re}from"./checkbox-ZoeZ6z8C.js";import{L as le}from"./leaf-Lr4USLAX.js";import{S as ae}from"./smartphone-B2A-wjKv.js";import{C as ie}from"./circle-alert-C1-S23ot.js";import{E as ne}from"./eye-off-BHMLpHkS.js";import{E as oe}from"./eye-ByvufGnD.js";import"./ui-CAx9UBAP.js";import"./index-CDAgKskh.js";import"./check-DidQSGY2.js";const Ce=()=>{const M=Z(),{signIn:O}=G(),{toast:D}=K(),[n,h]=a.useState(""),[C,J]=a.useState(""),[f,B]=a.useState(!1),[L,E]=a.useState(!1),[k,j]=a.useState(!1),[u,p]=a.useState([]),[o,v]=a.useState(!1),[c,y]=a.useState(0),[N,P]=a.useState(""),$=a.useRef(null),q=a.useRef(null);a.useEffect(()=>{P((()=>{const i=document.createElement("canvas"),d=i.getContext("2d");d&&(d.textBaseline="top",d.font="14px Arial",d.fillText("Device fingerprint",2,2));const g=[navigator.userAgent,navigator.language,screen.width+"x"+screen.height,Intl.DateTimeFormat().resolvedOptions().timeZone,i.toDataURL()].join("|");let m=0;for(let x=0;x<g.length;x++){const W=g.charCodeAt(x);m=(m<<5)-m+W,m=m&m}return Math.abs(m).toString(36)})());const r=localStorage.getItem("rememberedEmail"),t=localStorage.getItem("rememberMe")==="true";r&&t&&(h(r),j(!0));const l=localStorage.getItem("loginFailedAttempts");if(l)try{const d=JSON.parse(l).filter(g=>Date.now()-g.timestamp<24*60*60*1e3);p(d),localStorage.setItem("loginFailedAttempts",JSON.stringify(d))}catch{localStorage.removeItem("loginFailedAttempts")}},[]),a.useEffect(()=>{if(c>0){const s=setTimeout(()=>{y(c-1)},1e3);return()=>clearTimeout(s)}else o&&c===0&&v(!1)},[c,o]);const w=()=>{const s=localStorage.getItem("trustedDevices");if(!s)return!1;try{return JSON.parse(s).some(t=>t.id===N&&t.trusted)}catch{return!1}},U=s=>s<3?0:s<5?30:s<7?120:s<10?300:900,S=s=>{const r=u.filter(t=>t.email===s&&Date.now()-t.timestamp<36e5);if(r.length>=3){const t=U(r.length),l=Math.max(...r.map(d=>d.timestamp)),i=Math.floor((Date.now()-l)/1e3);if(i<t)return y(t-i),!0}return!1},V=s=>{const r={timestamp:Date.now(),email:s},t=[...u,r];if(p(t),localStorage.setItem("loginFailedAttempts",JSON.stringify(t)),S(s)){v(!0);const l=t.filter(i=>i.email===s&&Date.now()-i.timestamp<60*60*1e3);D({title:"Too Many Failed Attempts",description:`Account temporarily locked. Please wait ${U(l.length)} seconds.`,variant:"destructive"})}},z=s=>{const r={id:N,name:`${navigator.platform} - ${new Date().toLocaleDateString()}`,lastSeen:Date.now(),trusted:!0},t=localStorage.getItem("trustedDevices");let l=[];if(t)try{l=JSON.parse(t)}catch{l=[]}l=l.filter(i=>i.id!==N),l.push(r),l.length>5&&(l=l.slice(-5)),localStorage.setItem("trustedDevices",JSON.stringify(l))},H=async s=>{if(s.preventDefault(),S(n)){v(!0);return}E(!0);try{const{error:r}=await O(n,C);if(r)V(n);else{const t=u.filter(l=>l.email!==n);p(t),localStorage.setItem("loginFailedAttempts",JSON.stringify(t)),k?(localStorage.setItem("rememberedEmail",n),localStorage.setItem("rememberMe","true"),w()||(z(n),D({title:"Device Remembered",description:"This device has been added to your trusted devices."}))):(localStorage.removeItem("rememberedEmail"),localStorage.setItem("rememberMe","false")),M("/dashboard")}}catch{V(n)}finally{E(!1)}},I=s=>u.filter(r=>r.email===s&&Date.now()-r.timestamp<60*60*1e3).length,A=s=>{const r=Math.floor(s/60),t=s%60;return`${r}:${t.toString().padStart(2,"0")}`};return e.jsxDEV("div",{className:"min-h-screen bg-gradient-to-br from-background to-secondary flex items-center justify-center p-4",children:e.jsxDEV("div",{className:"w-full max-w-md space-y-6",children:[e.jsxDEV("div",{className:"text-center space-y-4",children:[e.jsxDEV("div",{className:"mx-auto w-16 h-16 bg-gradient-to-br from-primary to-primary-light rounded-full flex items-center justify-center",children:e.jsxDEV(le,{className:"h-8 w-8 text-primary-foreground"},void 0,!1,{fileName:"C:/Users/dell/Desktop/verdant-village-store/src/pages/Login.tsx",lineNumber:299,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/dell/Desktop/verdant-village-store/src/pages/Login.tsx",lineNumber:298,columnNumber:11},void 0),e.jsxDEV("div",{children:[e.jsxDEV("h1",{className:"text-2xl font-bold text-foreground",children:"FarmersBracket"},void 0,!1,{fileName:"C:/Users/dell/Desktop/verdant-village-store/src/pages/Login.tsx",lineNumber:302,columnNumber:13},void 0),e.jsxDEV("p",{className:"text-muted-foreground",children:"shopleft"},void 0,!1,{fileName:"C:/Users/dell/Desktop/verdant-village-store/src/pages/Login.tsx",lineNumber:303,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/dell/Desktop/verdant-village-store/src/pages/Login.tsx",lineNumber:301,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/dell/Desktop/verdant-village-store/src/pages/Login.tsx",lineNumber:297,columnNumber:9},void 0),w()&&e.jsxDEV("div",{className:"flex items-center justify-center gap-2 p-3 bg-green-50 border border-green-200 rounded-lg",children:[e.jsxDEV(ae,{className:"h-4 w-4 text-green-600"},void 0,!1,{fileName:"C:/Users/dell/Desktop/verdant-village-store/src/pages/Login.tsx",lineNumber:310,columnNumber:13},void 0),e.jsxDEV("span",{className:"text-sm text-green-800 font-medium",children:"Trusted Device"},void 0,!1,{fileName:"C:/Users/dell/Desktop/verdant-village-store/src/pages/Login.tsx",lineNumber:311,columnNumber:13},void 0),e.jsxDEV(Q,{className:"h-4 w-4 text-green-600"},void 0,!1,{fileName:"C:/Users/dell/Desktop/verdant-village-store/src/pages/Login.tsx",lineNumber:312,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/dell/Desktop/verdant-village-store/src/pages/Login.tsx",lineNumber:309,columnNumber:11},void 0),o&&e.jsxDEV("div",{className:"flex items-center gap-2 p-4 bg-red-50 border border-red-200 rounded-lg",children:[e.jsxDEV(X,{className:"h-5 w-5 text-red-600"},void 0,!1,{fileName:"C:/Users/dell/Desktop/verdant-village-store/src/pages/Login.tsx",lineNumber:319,columnNumber:13},void 0),e.jsxDEV("div",{className:"flex-1",children:[e.jsxDEV("p",{className:"text-sm font-medium text-red-800",children:"Account Temporarily Locked"},void 0,!1,{fileName:"C:/Users/dell/Desktop/verdant-village-store/src/pages/Login.tsx",lineNumber:321,columnNumber:15},void 0),e.jsxDEV("p",{className:"text-xs text-red-600",children:["Too many failed attempts. Try again in ",A(c)]},void 0,!0,{fileName:"C:/Users/dell/Desktop/verdant-village-store/src/pages/Login.tsx",lineNumber:322,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/dell/Desktop/verdant-village-store/src/pages/Login.tsx",lineNumber:320,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/dell/Desktop/verdant-village-store/src/pages/Login.tsx",lineNumber:318,columnNumber:11},void 0),e.jsxDEV(Y,{className:"shadow-medium",children:[e.jsxDEV(_,{className:"space-y-1",children:[e.jsxDEV(ee,{className:"text-2xl text-center",children:"Welcome Back"},void 0,!1,{fileName:"C:/Users/dell/Desktop/verdant-village-store/src/pages/Login.tsx",lineNumber:332,columnNumber:13},void 0),e.jsxDEV(se,{className:"text-center",children:"Sign in to your account to continue shopping"},void 0,!1,{fileName:"C:/Users/dell/Desktop/verdant-village-store/src/pages/Login.tsx",lineNumber:333,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/dell/Desktop/verdant-village-store/src/pages/Login.tsx",lineNumber:331,columnNumber:11},void 0),e.jsxDEV(te,{className:"space-y-4",children:[e.jsxDEV("form",{onSubmit:H,className:"space-y-4",children:[e.jsxDEV("div",{className:"space-y-2",children:[e.jsxDEV(b,{htmlFor:"email",children:"Email"},void 0,!1,{fileName:"C:/Users/dell/Desktop/verdant-village-store/src/pages/Login.tsx",lineNumber:340,columnNumber:17},void 0),e.jsxDEV(T,{ref:$,id:"email",name:"email",type:"email",placeholder:"Enter your email",value:n,onChange:s=>h(s.target.value),required:!0,className:"h-11",autoComplete:"email",disabled:o},void 0,!1,{fileName:"C:/Users/dell/Desktop/verdant-village-store/src/pages/Login.tsx",lineNumber:341,columnNumber:17},void 0),n&&I(n)>0&&e.jsxDEV("p",{className:"text-xs text-yellow-600 flex items-center gap-1",children:[e.jsxDEV(ie,{className:"h-3 w-3"},void 0,!1,{fileName:"C:/Users/dell/Desktop/verdant-village-store/src/pages/Login.tsx",lineNumber:356,columnNumber:21},void 0),I(n)," failed attempt(s) in the last hour"]},void 0,!0,{fileName:"C:/Users/dell/Desktop/verdant-village-store/src/pages/Login.tsx",lineNumber:355,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/dell/Desktop/verdant-village-store/src/pages/Login.tsx",lineNumber:339,columnNumber:15},void 0),e.jsxDEV("div",{className:"space-y-2",children:[e.jsxDEV(b,{htmlFor:"password",children:"Password"},void 0,!1,{fileName:"C:/Users/dell/Desktop/verdant-village-store/src/pages/Login.tsx",lineNumber:363,columnNumber:17},void 0),e.jsxDEV("div",{className:"relative",children:[e.jsxDEV(T,{ref:q,id:"password",name:"password",type:f?"text":"password",placeholder:"Enter your password",value:C,onChange:s=>J(s.target.value),required:!0,className:"h-11 pr-10",autoComplete:"current-password",disabled:o},void 0,!1,{fileName:"C:/Users/dell/Desktop/verdant-village-store/src/pages/Login.tsx",lineNumber:365,columnNumber:19},void 0),e.jsxDEV(F,{type:"button",variant:"ghost",size:"sm",className:"absolute right-0 top-0 h-full px-3 py-2 hover:bg-transparent",onClick:()=>B(!f),disabled:o,tabIndex:-1,children:f?e.jsxDEV(ne,{className:"h-4 w-4 text-muted-foreground"},void 0,!1,{fileName:"C:/Users/dell/Desktop/verdant-village-store/src/pages/Login.tsx",lineNumber:389,columnNumber:23},void 0):e.jsxDEV(oe,{className:"h-4 w-4 text-muted-foreground"},void 0,!1,{fileName:"C:/Users/dell/Desktop/verdant-village-store/src/pages/Login.tsx",lineNumber:391,columnNumber:23},void 0)},void 0,!1,{fileName:"C:/Users/dell/Desktop/verdant-village-store/src/pages/Login.tsx",lineNumber:379,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/dell/Desktop/verdant-village-store/src/pages/Login.tsx",lineNumber:364,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/dell/Desktop/verdant-village-store/src/pages/Login.tsx",lineNumber:362,columnNumber:15},void 0),e.jsxDEV("div",{className:"flex items-center justify-between",children:[e.jsxDEV("div",{className:"flex items-center space-x-2",children:[e.jsxDEV(re,{id:"remember-me",checked:k,onCheckedChange:s=>j(s),disabled:o},void 0,!1,{fileName:"C:/Users/dell/Desktop/verdant-village-store/src/pages/Login.tsx",lineNumber:402,columnNumber:19},void 0),e.jsxDEV(b,{htmlFor:"remember-me",className:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",children:"Remember me on this device"},void 0,!1,{fileName:"C:/Users/dell/Desktop/verdant-village-store/src/pages/Login.tsx",lineNumber:408,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/dell/Desktop/verdant-village-store/src/pages/Login.tsx",lineNumber:401,columnNumber:17},void 0),e.jsxDEV(R,{to:"/reset-password",className:"text-sm text-primary hover:underline",children:"Forgot Password?"},void 0,!1,{fileName:"C:/Users/dell/Desktop/verdant-village-store/src/pages/Login.tsx",lineNumber:415,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/dell/Desktop/verdant-village-store/src/pages/Login.tsx",lineNumber:400,columnNumber:15},void 0),e.jsxDEV(F,{type:"submit",className:"w-full h-11 bg-gradient-to-r from-primary to-primary-light",disabled:L||o,children:L?"Signing in...":o?`Locked (${A(c)})`:"Sign In"},void 0,!1,{fileName:"C:/Users/dell/Desktop/verdant-village-store/src/pages/Login.tsx",lineNumber:424,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/dell/Desktop/verdant-village-store/src/pages/Login.tsx",lineNumber:338,columnNumber:13},void 0),e.jsxDEV("div",{className:"text-center text-sm",children:[e.jsxDEV("span",{className:"text-muted-foreground",children:"Don't have an account? "},void 0,!1,{fileName:"C:/Users/dell/Desktop/verdant-village-store/src/pages/Login.tsx",lineNumber:440,columnNumber:15},void 0),e.jsxDEV(R,{to:"/register",className:"text-primary hover:underline font-medium",children:"Sign up here"},void 0,!1,{fileName:"C:/Users/dell/Desktop/verdant-village-store/src/pages/Login.tsx",lineNumber:441,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/dell/Desktop/verdant-village-store/src/pages/Login.tsx",lineNumber:439,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/dell/Desktop/verdant-village-store/src/pages/Login.tsx",lineNumber:337,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/dell/Desktop/verdant-village-store/src/pages/Login.tsx",lineNumber:330,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/dell/Desktop/verdant-village-store/src/pages/Login.tsx",lineNumber:293,columnNumber:7},void 0)},void 0,!1,{fileName:"C:/Users/dell/Desktop/verdant-village-store/src/pages/Login.tsx",lineNumber:292,columnNumber:5},void 0)};export{Ce as default};
