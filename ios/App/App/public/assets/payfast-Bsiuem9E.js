var d=Object.defineProperty;var l=(n,e,t)=>e in n?d(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var c=(n,e,t)=>l(n,typeof e!="symbol"?e+"":e,t);const m={merchantId:"10004002",merchantKey:"q1cd2rdny4a53",passphrase:"jt7NOE43FZPn",sandbox:!1,signatureUrl:"http://localhost:3001/api/payfast-signature"},a={sandbox:"https://sandbox.payfast.co.za/eng/process",production:"https://www.payfast.co.za/eng/process"};class h{constructor(e=m){c(this,"config");this.config=e}async generateSignature(e){try{const t=await fetch(this.config.signatureUrl,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok)throw new Error("Failed to generate signature");return(await t.json()).signature}catch(t){throw console.error("Error generating signature:",t),new Error("Payment signature generation failed")}}async createPayment(e){var r,s;const t=window.location.origin,i={merchant_id:this.config.merchantId,merchant_key:this.config.merchantKey,return_url:`${t}/payment-success`,cancel_url:`${t}/payment-cancelled`,notify_url:`${t}/api/payment-notify`,amount:e.amount.toFixed(2),item_name:e.itemName,item_description:e.itemDescription||e.itemName,email_address:e.customerEmail,name_first:((r=e.customerName)==null?void 0:r.split(" ")[0])||"",name_last:((s=e.customerName)==null?void 0:s.split(" ").slice(1).join(" "))||"",cell_number:e.customerCell,m_payment_id:e.orderId||Date.now().toString(),custom_str1:e.orderId},o=await this.generateSignature(i);return{...i,signature:o}}getPaymentUrl(){return this.config.sandbox?a.sandbox:a.production}redirectToPayment(e){const t=document.createElement("form");t.method="POST",t.action=this.getPaymentUrl(),t.style.display="none",Object.entries(e).forEach(([i,o])=>{if(o!=null&&o!==""){const r=document.createElement("input");r.type="hidden",r.name=i,r.value=o.toString(),t.appendChild(r)}}),document.body.appendChild(t),t.submit(),document.body.removeChild(t)}}var u=(n=>(n.PENDING="pending",n.PROCESSING="processing",n.COMPLETED="completed",n.FAILED="failed",n.CANCELLED="cancelled",n))(u||{});export{u as P,h as a};
