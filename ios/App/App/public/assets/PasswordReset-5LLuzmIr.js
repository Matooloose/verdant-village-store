import{u as $,J as G,a as K,h as Q,s as y,j as e,B as n,C as h,c as P,d as C,q as k,e as E,i as S}from"./index-cM6hlhfj.js";import{r as t}from"./vendor-Gsz-jK4b.js";import{I as R}from"./input-lvqziEey.js";import{L as U}from"./label-D9QexlfX.js";import{A as X}from"./arrow-left-DjF5G2qn.js";import{M as ee}from"./mail-DPZzi_yN.js";import{L as se}from"./lock-D5uPprrW.js";import{E as L}from"./eye-off-BHMLpHkS.js";import{E as q}from"./eye-ByvufGnD.js";import"./ui-CAx9UBAP.js";const ce=()=>{const N=$(),[c]=G(),{resetPassword:A}=K(),{toast:v}=Q(),[u,p]=t.useState("request"),[g,T]=t.useState(""),[f,B]=t.useState(""),[b,F]=t.useState(""),[w,Y]=t.useState(!1),[D,I]=t.useState(!1),[i,m]=t.useState(!1),[l,d]=t.useState({});t.useEffect(()=>{const s=a=>{const j=c.get(a);if(j)return j;const V=window.location.hash||"";if(!V)return null;try{return new URLSearchParams(V.replace(/^#/,"")).get(a)}catch{return null}},o=s("access_token"),r=s("refresh_token"),x=s("type");o&&r&&x==="recovery"&&y.auth.setSession({access_token:o,refresh_token:r}).then(()=>{try{if(window.history&&window.history.replaceState){const a=window.location.pathname+window.location.search;window.history.replaceState({},document.title,a)}}catch(a){console.error("Failed to clear URL fragment",a)}p("reset")}).catch(a=>{console.error("Error setting session:",a),v({title:"Invalid Reset Link",description:"The password reset link is invalid or expired. Please request a new one.",variant:"destructive"})})},[c,v]);const M=s=>{if(!s)return"Email is required";if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(s))return"Please enter a valid email"},_=s=>{if(!s)return"Password is required";if(s.length<8)return"Password must be at least 8 characters";if(!/(?=.*[a-z])/.test(s))return"Password must contain at least one lowercase letter";if(!/(?=.*[A-Z])/.test(s))return"Password must contain at least one uppercase letter";if(!/(?=.*\d)/.test(s))return"Password must contain at least one number"},z=async s=>{s.preventDefault(),m(!0),d({});const o=M(g);if(o){d({email:o}),m(!1);return}try{const{error:r}=await A(g);if(r){d({email:r.message});return}v({title:"Reset Email Sent",description:"Check your email for password reset instructions."}),p("success")}catch(r){console.error("Error requesting password reset:",r),d({email:"Failed to send reset email. Please try again."})}finally{m(!1)}},W=async s=>{s.preventDefault(),m(!0),d({});const o=_(f);if(o){d({password:o}),m(!1);return}if(f!==b){d({confirmPassword:"Passwords do not match"}),m(!1);return}try{const{error:r}=await y.auth.updateUser({password:f});if(r)throw r;v({title:"Password Updated",description:"Your password has been successfully updated."}),setTimeout(()=>{N("/login")},2e3),p("success")}catch(r){console.error("Error updating password:",r);let x="Failed to update password. Please try again.";if(r&&typeof r=="object"&&"message"in r){const a=r.message;typeof a=="string"&&(x=a)}d({password:x})}finally{m(!1)}},H=()=>e.jsxDEV(h,{children:[e.jsxDEV(P,{className:"text-center",children:[e.jsxDEV(ee,{className:"h-16 w-16 text-blue-500 mx-auto mb-4"},void 0,!1,{fileName:"C:/Users/dell/Desktop/verdant-village-store/src/pages/PasswordReset.tsx",lineNumber:190,columnNumber:9},void 0),e.jsxDEV(C,{className:"text-2xl",children:"Reset Your Password"},void 0,!1,{fileName:"C:/Users/dell/Desktop/verdant-village-store/src/pages/PasswordReset.tsx",lineNumber:191,columnNumber:9},void 0),e.jsxDEV(k,{children:"Enter your email address and we'll send you a link to reset your password."},void 0,!1,{fileName:"C:/Users/dell/Desktop/verdant-village-store/src/pages/PasswordReset.tsx",lineNumber:192,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/dell/Desktop/verdant-village-store/src/pages/PasswordReset.tsx",lineNumber:189,columnNumber:7},void 0),e.jsxDEV(E,{children:e.jsxDEV("form",{onSubmit:z,className:"space-y-4",children:[e.jsxDEV("div",{className:"space-y-2",children:[e.jsxDEV(U,{htmlFor:"email",children:"Email Address"},void 0,!1,{fileName:"C:/Users/dell/Desktop/verdant-village-store/src/pages/PasswordReset.tsx",lineNumber:200,columnNumber:13},void 0),e.jsxDEV(R,{id:"email",type:"email",value:g,onChange:s=>T(s.target.value),placeholder:"Enter your email address",disabled:i,className:l.email?"border-red-500":""},void 0,!1,{fileName:"C:/Users/dell/Desktop/verdant-village-store/src/pages/PasswordReset.tsx",lineNumber:201,columnNumber:13},void 0),l.email&&e.jsxDEV("p",{className:"text-sm text-red-500",children:l.email},void 0,!1,{fileName:"C:/Users/dell/Desktop/verdant-village-store/src/pages/PasswordReset.tsx",lineNumber:211,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/dell/Desktop/verdant-village-store/src/pages/PasswordReset.tsx",lineNumber:199,columnNumber:11},void 0),e.jsxDEV(n,{type:"submit",disabled:i||!g,className:"w-full",children:i?"Sending...":"Send Reset Email"},void 0,!1,{fileName:"C:/Users/dell/Desktop/verdant-village-store/src/pages/PasswordReset.tsx",lineNumber:215,columnNumber:11},void 0),e.jsxDEV("div",{className:"text-center",children:e.jsxDEV(n,{type:"button",variant:"ghost",onClick:()=>N("/login"),className:"text-sm",children:"Back to Login"},void 0,!1,{fileName:"C:/Users/dell/Desktop/verdant-village-store/src/pages/PasswordReset.tsx",lineNumber:224,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/dell/Desktop/verdant-village-store/src/pages/PasswordReset.tsx",lineNumber:223,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/dell/Desktop/verdant-village-store/src/pages/PasswordReset.tsx",lineNumber:198,columnNumber:9},void 0)},void 0,!1,{fileName:"C:/Users/dell/Desktop/verdant-village-store/src/pages/PasswordReset.tsx",lineNumber:197,columnNumber:7},void 0)]},void 0,!0,{fileName:"C:/Users/dell/Desktop/verdant-village-store/src/pages/PasswordReset.tsx",lineNumber:188,columnNumber:5},void 0),J=()=>e.jsxDEV(h,{children:[e.jsxDEV(P,{className:"text-center",children:[e.jsxDEV(se,{className:"h-16 w-16 text-green-500 mx-auto mb-4"},void 0,!1,{fileName:"C:/Users/dell/Desktop/verdant-village-store/src/pages/PasswordReset.tsx",lineNumber:241,columnNumber:9},void 0),e.jsxDEV(C,{className:"text-2xl",children:"Set New Password"},void 0,!1,{fileName:"C:/Users/dell/Desktop/verdant-village-store/src/pages/PasswordReset.tsx",lineNumber:242,columnNumber:9},void 0),e.jsxDEV(k,{children:"Choose a strong password for your account."},void 0,!1,{fileName:"C:/Users/dell/Desktop/verdant-village-store/src/pages/PasswordReset.tsx",lineNumber:243,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/dell/Desktop/verdant-village-store/src/pages/PasswordReset.tsx",lineNumber:240,columnNumber:7},void 0),e.jsxDEV(E,{children:e.jsxDEV("form",{onSubmit:W,className:"space-y-4",children:[e.jsxDEV("div",{className:"space-y-2",children:[e.jsxDEV(U,{htmlFor:"password",children:"New Password"},void 0,!1,{fileName:"C:/Users/dell/Desktop/verdant-village-store/src/pages/PasswordReset.tsx",lineNumber:251,columnNumber:13},void 0),e.jsxDEV("div",{className:"relative",children:[e.jsxDEV(R,{id:"password",type:w?"text":"password",value:f,onChange:s=>B(s.target.value),placeholder:"Enter new password",disabled:i,className:l.password?"border-red-500 pr-10":"pr-10"},void 0,!1,{fileName:"C:/Users/dell/Desktop/verdant-village-store/src/pages/PasswordReset.tsx",lineNumber:253,columnNumber:15},void 0),e.jsxDEV(n,{type:"button",variant:"ghost",size:"sm",className:"absolute right-0 top-0 h-full px-3",onClick:()=>Y(!w),children:w?e.jsxDEV(L,{className:"h-4 w-4"},void 0,!1,{fileName:"C:/Users/dell/Desktop/verdant-village-store/src/pages/PasswordReset.tsx",lineNumber:269,columnNumber:33},void 0):e.jsxDEV(q,{className:"h-4 w-4"},void 0,!1,{fileName:"C:/Users/dell/Desktop/verdant-village-store/src/pages/PasswordReset.tsx",lineNumber:269,columnNumber:66},void 0)},void 0,!1,{fileName:"C:/Users/dell/Desktop/verdant-village-store/src/pages/PasswordReset.tsx",lineNumber:262,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/dell/Desktop/verdant-village-store/src/pages/PasswordReset.tsx",lineNumber:252,columnNumber:13},void 0),l.password&&e.jsxDEV("p",{className:"text-sm text-red-500",children:l.password},void 0,!1,{fileName:"C:/Users/dell/Desktop/verdant-village-store/src/pages/PasswordReset.tsx",lineNumber:273,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/dell/Desktop/verdant-village-store/src/pages/PasswordReset.tsx",lineNumber:250,columnNumber:11},void 0),e.jsxDEV("div",{className:"space-y-2",children:[e.jsxDEV(U,{htmlFor:"confirmPassword",children:"Confirm New Password"},void 0,!1,{fileName:"C:/Users/dell/Desktop/verdant-village-store/src/pages/PasswordReset.tsx",lineNumber:278,columnNumber:13},void 0),e.jsxDEV("div",{className:"relative",children:[e.jsxDEV(R,{id:"confirmPassword",type:D?"text":"password",value:b,onChange:s=>F(s.target.value),placeholder:"Confirm new password",disabled:i,className:l.confirmPassword?"border-red-500 pr-10":"pr-10"},void 0,!1,{fileName:"C:/Users/dell/Desktop/verdant-village-store/src/pages/PasswordReset.tsx",lineNumber:280,columnNumber:15},void 0),e.jsxDEV(n,{type:"button",variant:"ghost",size:"sm",className:"absolute right-0 top-0 h-full px-3",onClick:()=>I(!D),children:D?e.jsxDEV(L,{className:"h-4 w-4"},void 0,!1,{fileName:"C:/Users/dell/Desktop/verdant-village-store/src/pages/PasswordReset.tsx",lineNumber:296,columnNumber:40},void 0):e.jsxDEV(q,{className:"h-4 w-4"},void 0,!1,{fileName:"C:/Users/dell/Desktop/verdant-village-store/src/pages/PasswordReset.tsx",lineNumber:296,columnNumber:73},void 0)},void 0,!1,{fileName:"C:/Users/dell/Desktop/verdant-village-store/src/pages/PasswordReset.tsx",lineNumber:289,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/dell/Desktop/verdant-village-store/src/pages/PasswordReset.tsx",lineNumber:279,columnNumber:13},void 0),l.confirmPassword&&e.jsxDEV("p",{className:"text-sm text-red-500",children:l.confirmPassword},void 0,!1,{fileName:"C:/Users/dell/Desktop/verdant-village-store/src/pages/PasswordReset.tsx",lineNumber:300,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/dell/Desktop/verdant-village-store/src/pages/PasswordReset.tsx",lineNumber:277,columnNumber:11},void 0),e.jsxDEV("div",{className:"text-sm text-muted-foreground bg-muted p-3 rounded-lg",children:[e.jsxDEV("p",{className:"font-medium mb-1",children:"Password requirements:"},void 0,!1,{fileName:"C:/Users/dell/Desktop/verdant-village-store/src/pages/PasswordReset.tsx",lineNumber:305,columnNumber:13},void 0),e.jsxDEV("ul",{className:"space-y-1 text-xs",children:[e.jsxDEV("li",{children:"• At least 8 characters long"},void 0,!1,{fileName:"C:/Users/dell/Desktop/verdant-village-store/src/pages/PasswordReset.tsx",lineNumber:307,columnNumber:15},void 0),e.jsxDEV("li",{children:"• Contains uppercase and lowercase letters"},void 0,!1,{fileName:"C:/Users/dell/Desktop/verdant-village-store/src/pages/PasswordReset.tsx",lineNumber:308,columnNumber:15},void 0),e.jsxDEV("li",{children:"• Contains at least one number"},void 0,!1,{fileName:"C:/Users/dell/Desktop/verdant-village-store/src/pages/PasswordReset.tsx",lineNumber:309,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/dell/Desktop/verdant-village-store/src/pages/PasswordReset.tsx",lineNumber:306,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/dell/Desktop/verdant-village-store/src/pages/PasswordReset.tsx",lineNumber:304,columnNumber:11},void 0),e.jsxDEV(n,{type:"submit",disabled:i||!f||!b,className:"w-full",children:i?"Updating...":"Update Password"},void 0,!1,{fileName:"C:/Users/dell/Desktop/verdant-village-store/src/pages/PasswordReset.tsx",lineNumber:313,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/dell/Desktop/verdant-village-store/src/pages/PasswordReset.tsx",lineNumber:249,columnNumber:9},void 0)},void 0,!1,{fileName:"C:/Users/dell/Desktop/verdant-village-store/src/pages/PasswordReset.tsx",lineNumber:248,columnNumber:7},void 0)]},void 0,!0,{fileName:"C:/Users/dell/Desktop/verdant-village-store/src/pages/PasswordReset.tsx",lineNumber:239,columnNumber:5},void 0),O=()=>e.jsxDEV(h,{children:[e.jsxDEV(P,{className:"text-center",children:[e.jsxDEV(S,{className:"h-16 w-16 text-green-500 mx-auto mb-4"},void 0,!1,{fileName:"C:/Users/dell/Desktop/verdant-village-store/src/pages/PasswordReset.tsx",lineNumber:328,columnNumber:9},void 0),e.jsxDEV(C,{className:"text-2xl",children:u==="success"&&c.get("type")==="recovery"?"Password Updated!":"Check Your Email"},void 0,!1,{fileName:"C:/Users/dell/Desktop/verdant-village-store/src/pages/PasswordReset.tsx",lineNumber:329,columnNumber:9},void 0),e.jsxDEV(k,{children:u==="success"&&c.get("type")==="recovery"?"Your password has been successfully updated. You can now log in with your new password.":"We've sent a password reset link to your email address. Please check your inbox and follow the instructions."},void 0,!1,{fileName:"C:/Users/dell/Desktop/verdant-village-store/src/pages/PasswordReset.tsx",lineNumber:332,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/dell/Desktop/verdant-village-store/src/pages/PasswordReset.tsx",lineNumber:327,columnNumber:7},void 0),e.jsxDEV(E,{className:"text-center space-y-4",children:[u==="success"&&c.get("type")==="recovery"?e.jsxDEV("div",{className:"space-y-4",children:[e.jsxDEV("div",{className:"inline-flex items-center gap-2 text-green-600 bg-green-50 px-4 py-2 rounded-lg",children:[e.jsxDEV(S,{className:"h-5 w-5"},void 0,!1,{fileName:"C:/Users/dell/Desktop/verdant-village-store/src/pages/PasswordReset.tsx",lineNumber:344,columnNumber:15},void 0),e.jsxDEV("span",{className:"font-medium",children:"Password Updated"},void 0,!1,{fileName:"C:/Users/dell/Desktop/verdant-village-store/src/pages/PasswordReset.tsx",lineNumber:345,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/dell/Desktop/verdant-village-store/src/pages/PasswordReset.tsx",lineNumber:343,columnNumber:13},void 0),e.jsxDEV("p",{className:"text-sm text-muted-foreground",children:"Redirecting to login..."},void 0,!1,{fileName:"C:/Users/dell/Desktop/verdant-village-store/src/pages/PasswordReset.tsx",lineNumber:347,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/dell/Desktop/verdant-village-store/src/pages/PasswordReset.tsx",lineNumber:342,columnNumber:11},void 0):e.jsxDEV("div",{className:"space-y-4",children:[e.jsxDEV("div",{className:"text-sm text-muted-foreground",children:[e.jsxDEV("p",{children:"Didn't receive the email?"},void 0,!1,{fileName:"C:/Users/dell/Desktop/verdant-village-store/src/pages/PasswordReset.tsx",lineNumber:354,columnNumber:15},void 0),e.jsxDEV("ul",{className:"mt-2 space-y-1",children:[e.jsxDEV("li",{children:"• Check your spam/junk folder"},void 0,!1,{fileName:"C:/Users/dell/Desktop/verdant-village-store/src/pages/PasswordReset.tsx",lineNumber:356,columnNumber:17},void 0),e.jsxDEV("li",{children:"• Make sure the email address is correct"},void 0,!1,{fileName:"C:/Users/dell/Desktop/verdant-village-store/src/pages/PasswordReset.tsx",lineNumber:357,columnNumber:17},void 0),e.jsxDEV("li",{children:"• Wait a few minutes for delivery"},void 0,!1,{fileName:"C:/Users/dell/Desktop/verdant-village-store/src/pages/PasswordReset.tsx",lineNumber:358,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/dell/Desktop/verdant-village-store/src/pages/PasswordReset.tsx",lineNumber:355,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/dell/Desktop/verdant-village-store/src/pages/PasswordReset.tsx",lineNumber:353,columnNumber:13},void 0),e.jsxDEV(n,{onClick:()=>p("request"),variant:"outline",children:"Try Again"},void 0,!1,{fileName:"C:/Users/dell/Desktop/verdant-village-store/src/pages/PasswordReset.tsx",lineNumber:362,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/dell/Desktop/verdant-village-store/src/pages/PasswordReset.tsx",lineNumber:352,columnNumber:11},void 0),e.jsxDEV("div",{className:"pt-4 border-t",children:e.jsxDEV(n,{variant:"ghost",onClick:()=>N("/login"),className:"text-sm",children:"Back to Login"},void 0,!1,{fileName:"C:/Users/dell/Desktop/verdant-village-store/src/pages/PasswordReset.tsx",lineNumber:372,columnNumber:11},void 0)},void 0,!1,{fileName:"C:/Users/dell/Desktop/verdant-village-store/src/pages/PasswordReset.tsx",lineNumber:371,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/dell/Desktop/verdant-village-store/src/pages/PasswordReset.tsx",lineNumber:340,columnNumber:7},void 0)]},void 0,!0,{fileName:"C:/Users/dell/Desktop/verdant-village-store/src/pages/PasswordReset.tsx",lineNumber:326,columnNumber:5},void 0);return e.jsxDEV("div",{className:"min-h-screen bg-background flex items-center justify-center p-4",children:e.jsxDEV("div",{className:"w-full max-w-md space-y-6",children:[e.jsxDEV(n,{variant:"ghost",onClick:()=>N("/login"),className:"mb-4",children:[e.jsxDEV(X,{className:"h-4 w-4 mr-2"},void 0,!1,{fileName:"C:/Users/dell/Desktop/verdant-village-store/src/pages/PasswordReset.tsx",lineNumber:392,columnNumber:11},void 0),"Back to Login"]},void 0,!0,{fileName:"C:/Users/dell/Desktop/verdant-village-store/src/pages/PasswordReset.tsx",lineNumber:387,columnNumber:9},void 0),u==="request"&&H(),u==="reset"&&J(),u==="success"&&O()]},void 0,!0,{fileName:"C:/Users/dell/Desktop/verdant-village-store/src/pages/PasswordReset.tsx",lineNumber:386,columnNumber:7},void 0)},void 0,!1,{fileName:"C:/Users/dell/Desktop/verdant-village-store/src/pages/PasswordReset.tsx",lineNumber:385,columnNumber:5},void 0)};export{ce as default};
